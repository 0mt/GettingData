#### How to read the dataset

To read a tidy data set stored in **tidyData.txt** into R use
**read.table(path\_to\_file, header = TRUE)**

#### Why is it tidy?

The command should return a data frame with 180 observations of 68
variables in the so-called wide data layout (a valid tidy data format).
In accordance with the definition of tidy data by Hadley Wickham
<http://www.stat.wvu.edu/~jharner/courses/stat623/docs/tidy-dataJSS.pdf>,
all values that characterize the same attribute (or feature in terms of
this study) measured/computed across all units (subject-activity pairs)
form a column. Values of all attributes measured/computed on the same
subject-activity pair form a row.

#### How is the dataset generated?

The tidy data set is generated by the **run\_analysis.R** script from
the raw data stored in the files /test/\*\_test.txt and
/train/\*\_train.txt. The script closely follows the guideline provided
in the assignment.

##### 1. Merges the training and the test sets to create one data set.

It is crucial to realize what constitutes the test and training sets and
how the data is distributed between subject\*.txt, y\*.txt and X\*.txt
files. Each subject\*.txt file stores a column of numerical IDs of those
who performed the activities. Each y\*.txt contains a column of
numerical activity IDs. And finally, each X\*.txt stores 561 columns of
measurements taken from the phones. First, we read the files into R

    subject <- read.table("./UCI HAR Dataset/train/subject_train.txt")
    y <- read.table("./UCI HAR Dataset/train/y_train.txt")
    x <- read.table("./UCI HAR Dataset/train/X_train.txt")

Then we build the training set

    train <- cbind("subject" = subject$V1, "activity" = y$V1, x)

Note that here we labeled the first two columns as "subject" and
"activity" in order to avoid duplicate column names.  
The test data set is made in the same way

    subject <- read.table("./UCI HAR Dataset/test/subject_test.txt")
    y <- read.table("./UCI HAR Dataset/test/y_test.txt")
    x <- read.table("./UCI HAR Dataset/test/X_test.txt")
    test <- cbind("subject" = subject$V1, "activity" = y$V1, x)

Now we merge the test and training data sets

    fullData <- rbind(test, train)

##### 2. Extracts only the measurements on the mean and standard deviation for each measurement.

Names of all columns of the fullData set, except for "subject" and
"activity", are stored in the features.txt file. We read those names in
the form of a character vector by means of

    varNames <- read.table("./UCI HAR Dataset/features.txt", stringsAsFactors = FALSE, row.names = 1)[,1]

The argument stringsAsFactors = FALSE prevents the names from conversion
into factor variables. The argument row.names = 1 guarantees that the
function grep(), which will be called on varNames in a moment, returns
correct positions of specified columns.  
The assignment is not completely clear on what columns to extract, all
that contain "mean" or "std" in their names or only those with "mean()"
or "std()". One can also argue that variables such as
angle(X,gravityMean), for example, are not the means. Therefore, we
choose the latter.

    cids <- grep("mean\\(\\)|std\\(\\)", varNames)

If you need columns with "mean" and "std", call grep("mean|std",
varNames) instead.  
Now we can select the (messy) data set requested in the assignment by
means of select() from the dplyr package.

    Data <- select(fullData, subject, activity, cids + 2)

Note that fullData has two extra columns (subject and activity) hence +
2.

##### 3. Uses descriptive activity names to name the activities in the data set.

Links between activity IDs (Data$activity) and their names are recorded
in the activity\_labels.txt. The script reads the file into R and
returns a character vector

    actNames <- read.table("./UCI HAR Dataset/activity_labels.txt", stringsAsFactors = FALSE, row.names = 1)[,1]

Then it replaces every element of Data$activity with its name

    Data$activity <- sapply(Data$activity, function(x) actNames[x])

##### 4. Appropriately labels the data set with descriptive variable names.

In my opinion, original variable names (listed in features.txt and
already stored into the varNames variable) represent an acceptable
balance of brevity and readability. So the code uses these names with
minor modifications. Namely, it drops out special symbols such as () and
-, and replaces "mean" and "std" with "Mean" and "Std". Although such a
labeling is not completely in line with the recommendations given in the
lectures, it significantly improves readability, IMHO

    cNames <- varNames[cids] %>% sapply(function(x) gsub("\\(\\)|-", "", x)) %>% 
            sapply(function(x) gsub("mean", "Mean", x)) %>%
            sapply(function(x) gsub("std", "Std", x))

Label the columns with the generated variable names

    colnames(Data) <- c("subject", "activity", cNames)

##### 5. From the data set in step 4, creates a second, independent tidy data set with the average of each variable for each activity and each subject.

This step is easy with the help of the dplyr package

    tidyData <- Data %>% group_by(subject, activity) %>% summarise_all(mean)

It returns a tidy data set in the so-called wide form (see the CodeBook
for additional information).
